<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Face Generator</title>

    <!-- jQuery -->
    <script
    src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E="
    crossorigin="anonymous"></script>

    <style>
      #faceContainer {
        border-radius: 50%;
        height: 293px;
        overflow: hidden;
        position: relative;
        width: 293px;
      }

      .image {
        position: absolute;
      }

    </style>

  </head>
  <body>
    <div id="faceContainer">
      <img class="image" id="bg" />
      <img class="image" id="face" />
      <img class="image" id="beard" />
      <img class="image" id="ear" />
      <img class="image" id="mouth" />
      <img class="image" id="nose" />
      <img class="image" id="eyes" />
      <img class="image" id="brows" />
      <img class="image" id="hair" />
    </div>

    <button id="regenerate">Regenerate</button>

    <select id="select_bg"></select>
    <select id="select_nose"></select>

    <script>
      var bg = 9,
          face= 4,
          skin = 5,
          beard = 3,
          hair = 7,
          hairColor = 5,
          mouth = 6,
          nose = 6,
          eyes = 6,
          brows = 3,
          beardChoice = 2,
          hairChoice = 10;

      // Function for filling in the src of an image based on the piece and variation.
      // eg, generate('face', 1);
      function generate(part, num) {
        $('#' + part).attr('src', part + '/' + part + '_0' + num + '.png');
        $('#select_' + part).val(num);
      }


      // A function for populating the select boxes for each of the pieces that don't require skin tone.
      function buildSelectSimple(part, num) {
        for(var i=1;i<=num;i++) {
          $('#select_' + part).append(`
            <option value="${i}">${i}</option>
            `);
        }

        $('#select_' + part).change(function(){
          generate(part, $(this).val());
          console.log($(this).val());
        });
      }

      buildSelectSimple('bg', bg);
      buildSelectSimple('nose', nose);



      // A crazy and inefficient function for creating the initial, randomized face.
      function makerandomface() {
        bg = Math.floor(Math.random() * 9)+1,
        face = Math.floor(Math.random() * 4)+1,
        skin = Math.floor(Math.random() * 5)+1,
        beard = Math.floor(Math.random() * 3)+1,
        hair = Math.floor(Math.random() * 7)+1,
        hairColor = Math.floor(Math.random() * 5)+1,
        mouth = Math.floor(Math.random() * 6)+1,
        nose = Math.floor(Math.random() * 6)+1,
        eyes = Math.floor(Math.random() * 6)+1,
        brows = Math.floor(Math.random() * 3)+1,
        beardChoice = Math.floor(Math.random() * 2),
        hairChoice = Math.floor(Math.random() * 10);

        generate('bg', bg);
        generate('face', face + '_0' + skin);
        if(eyes != 2 && eyes != 4 && eyes != 6 && mouth != 4 && mouth != 5 && mouth != 6) {
          if(beardChoice < 1) {
            generate('beard', beard + '_0' + hairColor);
          }
        } else {
          $('#beard').attr('src','');
        }
        generate('ear', skin);
        generate('mouth', mouth);
        generate('nose', nose);
        generate('eyes', eyes);
        generate('brows', brows + '_0' + hairColor);
        if(hairChoice < 9) {
          generate('hair', hair + '_0' + hairColor);
        } else {
          $('#hair').attr('src','');
        }
      }

      $(document).ready(function(){
        makerandomface();
      });

      $('#regenerate').on('click', function(){
        makerandomface();
      });
    </script>

  </body>
</html>
